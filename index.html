<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>PCP</title>
</head>
<body>
<h1>PCP - Dashboard</h1>

<label>Tipo:</label>
<select id="tipo">
  <option value="pequeno">parafuso pequeno</option>
  <option value="grande">parafuso grande</option>
</select>

<label>Quantidade:</label>
<input type="number" id="qtd" />

<button id="add">Adicionar Ordem</button>
<button id="reset">Reiniciar pedidos do dia</button>

<h2>Fila de ordens</h2>
<div id="fila"></div>

<h2>Status dos postos</h2>
<div id="postos"></div>

<script type="module">
import {db, ref, push, onValue, update, remove} from "./firebase.js";

add.onclick = () => {
  push(ref(db, "orders"), {
    tipo: tipo.value,
    qtd: Number(qtd.value),
    etapa: 0,
    status: "pendente"
  })
}

reset.onclick = ()=>{
  remove(ref(db,"orders"))
}

onValue(ref(db,"orders"), snap=>{
  fila.innerHTML = ""
  const orders = snap.val()
  if(!orders) return
  Object.entries(orders).forEach(([id,o])=>{
    fila.innerHTML += `<div>#${id} – ${o.tipo} – etapa:${o.etapa} – status:${o.status}</div>`
  })
})

onValue(ref(db,"posts"), snap=>{
  postos.innerHTML = ""
  const p = snap.val()||{}
  Object.entries(p).forEach(([id,post])=>{
    postos.innerHTML += `<div>Posto ${id} — atual:${post.currentOrder||"-"} — ANDON:${post.andon||"ok"}</div>`
  })
})
</script>
</body>
</htdia</button>

<h2>Fila de ordens</h2>
<div id="fila"></div>

<h2>Status dos postos</h2>
<div id="postos"></div>

<script type="module">
import {db, ref, push, onValue, update, remove} from "./firebase.js";

add.onclick = () => {
  push(ref(db, "orders"), {
    tipo: tipo.value,
    qtd: Number(qtd.value),
    etapa: 0,
    status: "pendente"
  })
}

reset.onclick = ()=>{
  remove(ref(db,"orders"))
}

onValue(ref(db,"orders"), snap=>{
  fila.innerHTML = ""
  const orders = snap.val()
  if(!orders) return
  Object.entries(orders).forEach(([id,o])=>{
    fila.innerHTML += `<div>#${id} – ${o.tipo} – etapa:${o.etapa} – status:${o.status}</div>`
  })
})

onValue(ref(db,"posts"), snap=>{
  postos.innerHTML = ""
  const p = snap.val()||{}
  Object.entries(p).forEach(([id,post])=>{
    postos.innerHTML += `<div>Posto ${id} — atual:${post.currentOrder||"-"} — ANDON:${post.andon||"ok"}</div>`
  })
})
</script>
</body>
</html>
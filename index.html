<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>PCP</title>
</head>
<body>
<h1>PCP - Dashboard</h1>

<label>Tipo:</label>
<select id="tipo">
  <option value="pequeno">parafuso pequeno</option>
  <option value="grande">parafuso grande</option>
</select>

<label>Quantidade:</label>
<input type="number" id="qtd" />

<button id="add">Adicionar Ordem</button>

<h2>Fila de ordens</h2>
<div id="fila"></div>

<h2>Status dos postos</h2>
<div id="postos"></div>

<script type="module">
import {db, ref, push, onValue, update} from "./firebase.js";

document.getElementById("add").onclick = () => {
  push(ref(db, "orders"), {
    tipo: document.getElementById("tipo").value,
    qtd: Number(document.getElementById("qtd").value),
    etapa: 0,           // posto atual → 0 = posto1
    status: "pendente"
  })
}

onValue(ref(db,"orders"), snap=>{
  const div = document.getElementById("fila")
  div.innerHTML = ""
  const orders = snap.val()
  if(!orders) return
  Object.entries(orders).forEach(([id,o])=>{
    div.innerHTML += `<div>#${id} – ${o.tipo} – etapa:${o.etapa} – status:${o.status}</div>`
  })
})

onValue(ref(db,"posts"), snap=>{
  const div = document.getElementById("postos")
  const p = snap.val()||{}
  div.innerHTML = ""
  Object.entries(p).forEach(([id,post])=>{
    div.innerHTML += `<div>Posto ${id} — atual:${post.currentOrder||"-"} — ANDON:${post.andon||"ok"}</div>`
  })
})
</script>


</body>
</html>
